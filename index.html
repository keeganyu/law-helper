<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åˆ‘è¾©å…¨èƒ½AIåŠ©æ‰‹</title>
    <style>
        /* --- åŸºç¡€æ ·å¼ --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", sans-serif; background-color: #f8fafc; color: #0f172a; position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; }
        
        /* --- å®¹å™¨ --- */
        #app-container { width: 100%; max-width: 450px; height: 100%; background: #fff; display: flex; flex-direction: column; position: relative; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        
        /* --- è§†å›¾åˆ‡æ¢é€»è¾‘ --- */
        .view { flex: 1; display: flex; flex-direction: column; overflow: hidden; display: none; height: 100%; }
        .view.active { display: flex; }
        .content-scroll { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; padding-bottom: 20px; }

        /* --- é¦–é¡µä»ªè¡¨ç›˜ --- */
        .dashboard-header { background: #0f172a; color: white; padding: 30px 24px 80px; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; position: relative; flex-shrink: 0; }
        .dashboard-grid { padding: 0 20px; margin-top: -60px; display: grid; gap: 16px; position: relative; z-index: 10; }
        
        .tool-card { background: white; border-radius: 16px; padding: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; display: flex; flex-direction: column; cursor: pointer; transition: transform 0.1s; position: relative; overflow: hidden; }
        .tool-card:active { transform: scale(0.98); background: #f8fafc; }
        .tool-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; margin-bottom: 12px; }
        .tool-title { font-size: 18px; font-weight: bold; color: #0f172a; margin-bottom: 4px; }
        .tool-desc { font-size: 12px; color: #64748b; line-height: 1.4; }
        .tool-tag { position: absolute; top: 12px; right: 12px; font-size: 10px; font-weight: bold; padding: 2px 6px; border-radius: 4px; }

        /* --- å¤´éƒ¨å¯¼èˆª --- */
        .nav-header { background: #0f172a; color: white; padding: 16px; display: flex; align-items: center; flex-shrink: 0; }
        .nav-title { flex: 1; text-align: center; font-size: 17px; font-weight: bold; margin-right: 32px; }
        .nav-back { background: rgba(255,255,255,0.1); border: none; color: white; width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; cursor: pointer; }

        /* --- é€šç”¨ç»„ä»¶ --- */
        .btn { border: none; outline: none; cursor: pointer; font-size: 16px; font-weight: bold; border-radius: 12px; padding: 14px; width: 100%; display: flex; align-items: center; justify-content: center; }
        .btn-primary { background: #2563eb; color: white; box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3); }
        .btn-outline { background: white; border: 1px solid #cbd5e1; color: #475569; }
        
        .input-group { margin-bottom: 20px; padding: 0 20px; }
        .label { display: block; font-weight: bold; font-size: 14px; margin-bottom: 8px; color: #334155; }
        input[type="date"], input[type="number"], select { width: 100%; padding: 12px; border: 1px solid #cbd5e1; border-radius: 10px; font-size: 16px; background: white; -webkit-appearance: none; }
        
        /* --- é‡åˆ‘æ»‘å—æ ·å¼ --- */
        .slider-container { padding: 0 20px; margin-bottom: 20px; }
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: white; border: 4px solid #2563eb; cursor: pointer; margin-top: -10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #e2e8f0; border-radius: 2px; }

        /* --- å–ä¿è¯„ä¼°æ ·å¼ --- */
        .check-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: white; border: 1px solid #e2e8f0; border-radius: 10px; margin-bottom: 8px; cursor: pointer; }
        .check-item.checked { border-color: #2563eb; background: #eff6ff; }
        .check-circle { width: 20px; height: 20px; border-radius: 50%; border: 2px solid #cbd5e1; display: flex; align-items: center; justify-content: center; margin-left: 10px; }
        .check-item.checked .check-circle { border-color: #2563eb; background: #2563eb; }
        .check-item.checked .check-circle::after { content: "âœ“"; color: white; font-size: 12px; }

        /* --- ç»“æœå±•ç¤ºæ¡† --- */
        .result-card { margin: 20px; padding: 20px; border-radius: 16px; text-align: center; }
        .result-score { font-size: 42px; font-weight: bold; margin: 10px 0; }
        
        /* --- åº•éƒ¨æ‚¬æµ® --- */
        .footer-fixed { flex-shrink: 0; padding: 12px 20px; background: white; border-top: 1px solid #e2e8f0; display: flex; gap: 12px; padding-bottom: max(12px, env(safe-area-inset-bottom)); }

        /* --- å¼¹çª— --- */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; display: none; align-items: flex-end; justify-content: center; }
        .modal-overlay.open { display: flex; }
        .modal-content { background: white; width: 100%; max-width: 450px; border-top-left-radius: 20px; border-top-right-radius: 20px; padding: 24px; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    </style>
</head>
<body>

<div id="app-container">
    
    <!-- View: Dashboard (é¦–é¡µ) -->
    <div id="view-home" class="view active">
        <div class="content-scroll">
            <div class="dashboard-header">
                <div style="font-size: 40px; margin-bottom: 10px;">âš–ï¸</div>
                <h1 style="margin: 0; font-size: 24px;">åˆ‘è¾©å…¨èƒ½AIåŠ©æ‰‹</h1>
                <p style="margin: 8px 0 0; opacity: 0.8; font-size: 13px;">ä¸“ä¸šå¾‹å¸ˆå›¢é˜Ÿç ”å‘ Â· åˆ‘äº‹æ¡ˆä»¶å®¶å±è‡ªåŠ©å†³ç­–ç³»ç»Ÿ</p>
            </div>
            
            <div class="dashboard-grid">
                <!-- Card 1: 37 Days -->
                <div class="tool-card" onclick="navigateTo('37days')">
                    <div class="tool-tag" style="background:#dcfce7; color:#166534;">æœ€å¸¸ç”¨</div>
                    <div class="tool-icon" style="background:#eff6ff; color:#2563eb;">ğŸ•</div>
                    <div class="tool-title">é»„é‡‘37å¤©æ•‘æ´</div>
                    <div class="tool-desc">æµ‹ç®—ä¾¦æŸ¥æœŸå…³é”®æ—¶é—´èŠ‚ç‚¹ï¼Œç”Ÿæˆå®¶å±è¡ŒåŠ¨æ¸…å•ã€‚</div>
                </div>
                
                <!-- Card 2: Sentencing -->
                <div class="tool-card" onclick="navigateTo('sentencing')">
                    <div class="tool-tag" style="background:#fff7ed; color:#9a3412;">ç»æµçŠ¯ç½ª</div>
                    <div class="tool-icon" style="background:#fff1f2; color:#be123c;">ğŸ“‰</div>
                    <div class="tool-title">é‡åˆ‘æ™ºèƒ½æ¨¡æ‹Ÿ</div>
                    <div class="tool-desc">è¾“å…¥æ¶‰æ¡ˆé‡‘é¢ï¼Œä¸€é”®é¢„æµ‹æ³•å®šåˆ‘æœŸä¸é™æ¡£æœºä¼šã€‚</div>
                </div>

                <!-- Card 3: Bail -->
                <div class="tool-card" onclick="navigateTo('bail')">
                    <div class="tool-tag" style="background:#f3e8ff; color:#6b21a8;">æˆåŠŸç‡</div>
                    <div class="tool-icon" style="background:#f0fdf4; color:#15803d;">ğŸ”“</div>
                    <div class="tool-title">å–ä¿å€™å®¡è¯„ä¼°</div>
                    <div class="tool-desc">å¤šç»´åº¦åˆ†æå–ä¿æ¦‚ç‡ï¼Œæä¾›æå‡æˆåŠŸç‡å»ºè®®ã€‚</div>
                </div>

                 <!-- Card 4: Centers -->
                 <div class="tool-card" onclick="navigateTo('guide')">
                    <div class="tool-tag" style="background:#e0f2fe; color:#0369a1;">æµ™æ±Ÿç‰ˆ</div>
                    <div class="tool-icon" style="background:#f0f9ff; color:#0ea5e9;">ğŸ¢</div>
                    <div class="tool-title">çœ‹å®ˆæ‰€å¯¼èˆª</div>
                    <div class="tool-desc">æµ™æ±Ÿå…¨çœçœ‹å®ˆæ‰€åœ°å€ã€ç”µè¯ã€å­˜é’±è¡£ç‰©è§„å®šå¤§å…¨ã€‚</div>
                </div>
                
                <!-- Contact Card -->
                <div class="tool-card" style="background: linear-gradient(135deg, #1e293b, #0f172a); border:none;" onclick="openContactModal()">
                    <div style="display:flex; align-items:center; justify-content:space-between; width:100%;">
                        <div>
                            <div class="tool-title" style="color:white; font-size:16px;">ğŸ“ å‘¼å«å¾‹å¸ˆç´§æ€¥ä»‹å…¥</div>
                            <div class="tool-desc" style="color:#94a3b8;">24å°æ—¶åˆ‘äº‹æ³•å¾‹æ´åŠ©çƒ­çº¿</div>
                        </div>
                        <div style="background:white; width:36px; height:36px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:18px;">â”</div>
                    </div>
                </div>
            </div>
            
            <div style="padding: 24px; text-align: center; color: #94a3b8; font-size: 12px;">
                æœ¬å·¥å…·ä»…ä¾›å‚è€ƒï¼Œä¸ä½œä¸ºæ­£å¼æ³•å¾‹æ„è§<br>å…·ä½“æ¡ˆæƒ…è¯·å’¨è¯¢å¾‹å¸ˆ
            </div>
        </div>
    </div>

    <!-- View: 37 Days (37å¤©æ•‘æ´) -->
    <div id="view-37days" class="view">
        <div class="nav-header">
            <button class="nav-back" onclick="navigateTo('home')">â†</button>
            <div class="nav-title">é»„é‡‘37å¤©æ•‘æ´ç³»ç»Ÿ</div>
        </div>
        <div class="content-scroll">
            <div style="padding: 20px;">
                <div class="input-group">
                    <span class="label">è¢«å¸¦èµ°/æ‹˜ç•™æ—¥æœŸ</span>
                    <input type="date" id="date-37" onchange="calc37Days()">
                </div>
                <div id="result-37" style="display:none;">
                    <div class="result-card" style="background:#f0f9ff; border:1px solid #bae6fd; text-align:left;">
                        <div style="font-size:12px; color:#0369a1;">å·²æ‹˜ç•™æ—¶é—´</div>
                        <div style="font-size:32px; font-weight:bold; color:#0c4a6e; margin: 4px 0;"><span id="days-passed">0</span> <span style="font-size:14px;">å¤©</span></div>
                        <div id="status-tag" style="display:inline-block; padding:4px 8px; background:#0284c7; color:white; border-radius:4px; font-size:12px; font-weight:bold;">ä¾¦æŸ¥é˜¶æ®µ</div>
                    </div>
                    
                    <div style="margin-top:20px;">
                        <div class="label">ğŸ“… å…³é”®èŠ‚ç‚¹å€’è®¡æ—¶</div>
                        <div style="background:white; border:1px solid #e2e8f0; border-radius:12px; padding:16px; margin-bottom:12px;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                                <span style="font-weight:bold; color:#1e293b;">ç¬¬30å¤© (æè¯·æ‰¹æ•)</span>
                                <span id="date-30" style="color:#64748b; font-size:14px;">--</span>
                            </div>
                            <div style="font-size:12px; color:#64748b;">åœ¨æ­¤ä¹‹å‰éœ€æäº¤ã€Šå–ä¿å€™å®¡ç”³è¯·ä¹¦ã€‹</div>
                        </div>
                        <div style="background:white; border:1px solid #e2e8f0; border-radius:12px; padding:16px;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                                <span style="font-weight:bold; color:#dc2626;">ç¬¬37å¤© (æ£€å¯Ÿé™¢æ‰¹æ•)</span>
                                <span id="date-37-end" style="color:#64748b; font-size:14px;">--</span>
                            </div>
                            <div style="font-size:12px; color:#64748b;">ç”Ÿæ­»7å¤©ï¼éœ€æäº¤ã€Šä¸äºˆæ‰¹æ•æ„è§ä¹¦ã€‹</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-fixed">
            <button class="btn btn-primary" onclick="openContactModal()">æˆ‘æ˜¯å®¶å±ï¼Œæ±‚åŠ©å¾‹å¸ˆ</button>
        </div>
    </div>

    <!-- View: Sentencing (é‡åˆ‘æ¨¡æ‹Ÿ) -->
    <div id="view-sentencing" class="view">
        <div class="nav-header">
            <button class="nav-back" onclick="navigateTo('home')">â†</button>
            <div class="nav-title">æ¶‰æ¡ˆé‡‘é¢é‡åˆ‘æ¨¡æ‹Ÿ</div>
        </div>
        <div class="content-scroll">
            <div style="padding: 20px;">
                <div class="input-group">
                    <span class="label">æ¶‰å«Œç½ªå</span>
                    <select id="crime-select" onchange="calcSentencing()">
                        <option value="fraud">è¯ˆéª—ç½ª</option>
                        <option value="embezzlement">èŒåŠ¡ä¾µå ç½ª</option>
                        <option value="illegal">éæ³•å¸æ”¶å…¬ä¼—å­˜æ¬¾</option>
                    </select>
                </div>

                <div class="input-group" style="text-align:center;">
                    <span class="label" style="text-align:left;">æ¶‰æ¡ˆé‡‘é¢ (å…ƒ)</span>
                    <div style="font-size:32px; font-weight:bold; color:#2563eb; margin:10px 0;">
                        Â¥ <span id="amount-display">80000</span>
                    </div>
                    <input type="range" id="amount-slider" min="0" max="1000000" step="5000" value="80000" oninput="updateAmount(this.value)">
                </div>

                <div class="result-card" id="sentencing-result" style="background:#fff7ed; border:1px solid #fed7aa;">
                    <div style="font-size:12px; color:#9a3412;">é¢„ä¼°æ³•å®šåˆ‘å¹…åº¦</div>
                    <div class="result-score" id="penalty-text" style="color:#c2410c; font-size:24px;">3å¹´ä»¥ä¸‹ / ç¼“åˆ‘</div>
                    <div style="font-size:12px; color:#9a3412;" id="threshold-desc">å½“å‰å±äºâ€œæ•°é¢è¾ƒå¤§â€</div>
                </div>
                
                <div style="background:#f0fdf4; border:1px solid #bbf7d0; border-radius:12px; padding:16px; font-size:13px; color:#166534; line-height:1.5; margin-top:20px;">
                    ğŸ’¡ <b>å¾‹å¸ˆæç¤ºï¼š</b><br>ä¾¦æŸ¥é˜¶æ®µè®¤å®šçš„é‡‘é¢å¾€å¾€åŒ…å«"æ°´åˆ†"ï¼ˆå¦‚æœªé‚é‡‘é¢ã€é‡å¤æµæ°´ï¼‰ã€‚æ ¸å‡é‡‘é¢æ˜¯é™ä½åˆ‘æœŸçš„æ ¸å¿ƒæ‰‹æ®µã€‚
                </div>
            </div>
        </div>
        <div class="footer-fixed">
            <button class="btn btn-primary" onclick="openContactModal()">å’¨è¯¢å¦‚ä½•æ ¸å‡é‡‘é¢</button>
        </div>
    </div>

    <!-- View: Bail (å–ä¿è¯„ä¼°) -->
    <div id="view-bail" class="view">
        <div class="nav-header">
            <button class="nav-back" onclick="navigateTo('home')">â†</button>
            <div class="nav-title">å–ä¿å€™å®¡æˆåŠŸç‡è¯„ä¼°</div>
        </div>
        <div class="content-scroll">
            <div style="padding: 20px;">
                <p style="font-size:12px; color:#64748b; margin-bottom:20px;">è¯·å‹¾é€‰ç¬¦åˆè¢«æ‹˜ç•™äººæƒ…å†µçš„é€‰é¡¹ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æµ‹ç®—æ¦‚ç‡ã€‚</p>
                
                <div class="check-item" onclick="toggleCheck(this, 10)">
                    <div>
                        <div style="font-weight:bold; font-size:14px;">æœ¬åœ°æˆ·ç± / æœ‰å›ºå®šä½æ‰€</div>
                        <div style="font-size:12px; color:#64748b;">ç¤¾ä¼šå±é™©æ€§è¾ƒä½</div>
                    </div>
                    <div class="check-circle"></div>
                </div>

                <div class="check-item" onclick="toggleCheck(this, 15)">
                    <div>
                        <div style="font-weight:bold; font-size:14px;">åˆçŠ¯ / å¶çŠ¯</div>
                        <div style="font-size:12px; color:#64748b;">æ— å‰ç§‘åŠ£è¿¹</div>
                    </div>
                    <div class="check-circle"></div>
                </div>

                <div class="check-item" onclick="toggleCheck(this, 20)">
                    <div>
                        <div style="font-weight:bold; font-size:14px;">å·²é€€èµƒ / å–å¾—è°…è§£</div>
                        <div style="font-size:12px; color:#64748b;">æœ€é‡è¦çš„åŠ åˆ†é¡¹</div>
                    </div>
                    <div class="check-circle"></div>
                </div>

                <div class="check-item" onclick="toggleCheck(this, 30)">
                    <div>
                        <div style="font-weight:bold; font-size:14px;">æ‚£æœ‰ä¸¥é‡ç–¾ç—… / æ€€å­•å“ºä¹³</div>
                        <div style="font-size:12px; color:#64748b;">äººé“ä¸»ä¹‰å–ä¿ç†ç”±</div>
                    </div>
                    <div class="check-circle"></div>
                </div>

                <div class="check-item" onclick="toggleCheck(this, 10)">
                    <div>
                        <div style="font-weight:bold; font-size:14px;">è®¤ç½ªè®¤ç½š / å£ä¾›ç¨³å®š</div>
                        <div style="font-size:12px; color:#64748b;">é…åˆä¾¦æŸ¥æ€åº¦è‰¯å¥½</div>
                    </div>
                    <div class="check-circle"></div>
                </div>

                <div class="result-card" style="background:#fdf4ff; border:1px solid #f0abfc; margin-top:24px;">
                    <div style="font-size:12px; color:#86198f;">é¢„ä¼°å–ä¿æˆåŠŸç‡</div>
                    <div class="result-score" id="bail-score" style="color:#a21caf;">20%</div>
                    <div id="bail-advice" style="font-size:12px; color:#86198f;">åŸºç¡€æ¦‚ç‡è¾ƒä½ï¼Œå»ºè®®å°½å¿«å¯»æ‰¾å¾‹å¸ˆä»‹å…¥ã€‚</div>
                </div>
            </div>
        </div>
        <div class="footer-fixed">
            <button class="btn btn-primary" onclick="openContactModal()">è·å–å–ä¿ç”³è¯·ä¹¦æ¨¡æ¿</button>
        </div>
    </div>

    <!-- View: Guide (çœ‹å®ˆæ‰€æŒ‡å— - æµ™æ±Ÿç‰ˆ) -->
    <div id="view-guide" class="view">
        <div class="nav-header">
            <button class="nav-back" onclick="navigateTo('home')">â†</button>
            <div class="nav-title">æµ™æ±Ÿçœçœ‹å®ˆæ‰€å¤§å…¨</div>
        </div>
        <div class="content-scroll">
            <div style="padding: 20px;">
                <div class="input-group" style="padding:0;">
                    <span class="label">é€‰æ‹©çœ‹å®ˆæ‰€</span>
                    <select id="center-select" onchange="updateCenterInfo()">
                        <optgroup label="æ­å·å¸‚">
                            <option value="hz_city">æ­å·å¸‚çœ‹å®ˆæ‰€</option>
                            <option value="hz_shangcheng">ä¸ŠåŸåŒºçœ‹å®ˆæ‰€</option>
                            <option value="hz_gongshu">æ‹±å¢…åŒºçœ‹å®ˆæ‰€</option>
                            <option value="hz_xihu">è¥¿æ¹–åŒºçœ‹å®ˆæ‰€</option>
                            <option value="hz_yuhang">ä½™æ­åŒºçœ‹å®ˆæ‰€</option>
                            <option value="hz_xiaoshan">è§å±±åŒºçœ‹å®ˆæ‰€</option>
                            <option value="hz_linping">ä¸´å¹³åŒºçœ‹å®ˆæ‰€</option>
                        </optgroup>
                        <optgroup label="å®æ³¢å¸‚">
                            <option value="nb_city">å®æ³¢å¸‚çœ‹å®ˆæ‰€</option>
                            <option value="nb_haishu">æµ·æ›™åŒºçœ‹å®ˆæ‰€</option>
                            <option value="nb_beilun">åŒ—ä»‘åŒºçœ‹å®ˆæ‰€</option>
                            <option value="nb_cixi">æ…ˆæºªå¸‚çœ‹å®ˆæ‰€</option>
                            <option value="nb_yuyao">ä½™å§šå¸‚çœ‹å®ˆæ‰€</option>
                        </optgroup>
                        <optgroup label="æ¸©å·å¸‚">
                            <option value="wz_city">æ¸©å·å¸‚çœ‹å®ˆæ‰€</option>
                        </optgroup>
                    </select>
                </div>
                
                <div id="center-info">
                    <!-- JS Populated -->
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Modal (Global) -->
    <div id="contact-modal" class="modal-overlay" onclick="closeContactModal(event)">
        <div class="modal-content">
            <h3 style="margin: 0 0 8px; font-size: 18px; font-weight: bold;">è”ç³»ä¿å¾‹å¸ˆå›¢é˜Ÿ</h3>
            <p style="margin: 0 0 24px; font-size: 13px; color: #64748b;">ä¸“ä¸šåˆ‘è¾©å¾‹å¸ˆå›¢é˜Ÿï¼Œ24å°æ—¶åœ¨çº¿è§£ç­”ã€‚</p>
            
            <a href="tel:13105565356" style="display: block; text-decoration: none;">
                <button class="btn btn-primary" style="margin-bottom: 12px; background: #22c55e;">ğŸ“ æ‹¨æ‰“ç”µè¯ (13105565356)</button>
            </a>
            <button class="btn btn-outline" style="background: #f8fafc;" onclick="copyWeChat()">ğŸ“‹ å¤åˆ¶å¾®ä¿¡å·</button>
            <button class="btn" style="background:transparent; color:#94a3b8; font-size:14px; margin-top:8px;" onclick="closeContactModal()">æš‚ä¸éœ€è¦</button>
        </div>
    </div>

</div>

<script>
    // --- Config ---
    const LAWYER_INFO = { phone: '13105565356', wechat: '13105565356' };

    // --- Data: Zhejiang Detention Centers ---
    const DETENTION_CENTERS = {
        // --- æ­å· ---
        'hz_city': {
            name: 'æ­å·å¸‚çœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚å¯Œé˜³åŒºä¸œæ´²è¡—é“é¸¡ç¬¼å±±æ‘',
            phone: '0571-87285200',
            money: 'æ¯æœˆ2000å…ƒ',
            clothes: 'ä¸æ”¶å¸¦æ‹‰é“¾/çº½æ‰£/ç»³ç´¢è¡£ç‰©ï¼Œä¸¥ç¦é‡‘å±ã€‚',
            nav: 'https://j.map.baidu.com/8f/3Q' // ç¤ºä¾‹å¯¼èˆªé“¾æ¥
        },
        'hz_shangcheng': {
            name: 'æ­å·å¸‚ä¸ŠåŸåŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚è¥¿æ¹–åŒºè½¬å¡˜è¡—é“è±¡å±±æ‘',
            phone: '0571-87095842',
            money: '2000å…ƒ (éƒ¨åˆ†çª—å£å¯å­˜)',
            clothes: 'æ£€æŸ¥ä¸¥æ ¼ï¼Œå»ºè®®å¯„é€å«è¡£/è¿åŠ¨è£¤ã€‚',
            nav: 'https://j.map.baidu.com/5c/jC'
        },
        'hz_gongshu': {
            name: 'æ­å·å¸‚æ‹±å¢…åŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚æ‹±å¢…åŒºåŠå±±è¡—é“æ²ˆå®¶æ¡¥',
            phone: '0571-88171722',
            money: '2000å…ƒ',
            clothes: 'éœ€å»é™¤æ‰€æœ‰é‡‘å±é…ä»¶ã€‚',
            nav: 'https://j.map.baidu.com/7e/K5'
        },
        'hz_xihu': {
            name: 'æ­å·å¸‚è¥¿æ¹–åŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚è¥¿æ¹–åŒºä¸‰å¢©é•‡æŒ¯åè·¯è¡ç‹å¤´',
            phone: '0571-88948200',
            money: 'æ¯æœˆ2000å…ƒ',
            clothes: 'ä¸æ”¶å¸¦å¸½è¡«ã€‚',
            nav: 'https://j.map.baidu.com/c2/fG' 
        },
        'hz_yuhang': {
            name: 'æ­å·å¸‚ä½™æ­åŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚ä½™æ­åŒºä»å’Œè¡—é“äº‘ä¼šæ‘',
            phone: '0571-86137304',
            money: '2000å…ƒ',
            clothes: 'æ£€æŸ¥ä¸¥æ ¼ã€‚',
            nav: 'https://j.map.baidu.com/4a/xL'
        },
        'hz_xiaoshan': {
            name: 'æ­å·å¸‚è§å±±åŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚è§å±±åŒºçº¢å¦å†œåœºçº¢åäº”çº¿',
            phone: '0571-82677109',
            money: '2000å…ƒ',
            clothes: 'ä¸æ”¶é‹å­ã€‚',
            nav: 'https://j.map.baidu.com/4a/xL'
        },
        'hz_linping': {
            name: 'æ­å·å¸‚ä¸´å¹³åŒºçœ‹å®ˆæ‰€',
            addr: 'æ­å·å¸‚ä¸´å¹³åŒºæ˜Ÿæ¡¥è¡—é“',
            phone: '0571-86137304', // åŸä½™æ­åˆ†å‡ºï¼Œç”µè¯å¯èƒ½æ²¿ç”¨æˆ–éœ€æ›´æ–°
            money: '2000å…ƒ',
            clothes: 'åŒä½™æ­æ ‡å‡†ã€‚',
            nav: 'https://j.map.baidu.com/b5/hN'
        },
        // --- å®æ³¢ ---
        'nb_city': {
            name: 'å®æ³¢å¸‚çœ‹å®ˆæ‰€',
            addr: 'å®æ³¢å¸‚æµ·æ›™åŒºä¸½å›­åŒ—è·¯489å¼„6å·',
            phone: '0574-81982114',
            money: '2000å…ƒ',
            clothes: 'å»ºè®®é‚®å±€æ±‡æ¬¾ã€‚',
            nav: 'https://j.map.baidu.com/1d/uP'
        },
        'nb_haishu': {
            name: 'å®æ³¢å¸‚æµ·æ›™åŒºçœ‹å®ˆæ‰€',
            addr: 'å®æ³¢å¸‚æµ·æ›™åŒºé„æ±Ÿé•‡å»ºå²™æ‘',
            phone: '0574-55831127',
            money: '2000å…ƒ',
            clothes: 'æ— é‡‘å±ã€‚',
            nav: 'https://j.map.baidu.com/2f/yR'
        },
        'nb_beilun': {
            name: 'å®æ³¢å¸‚åŒ—ä»‘åŒºçœ‹å®ˆæ‰€',
            addr: 'å®æ³¢å¸‚åŒ—ä»‘åŒºæ–°ç¢¶è¡—é“',
            phone: '0574-86775753',
            money: '2000å…ƒ',
            clothes: 'æ£€æŸ¥ä¸¥æ ¼ã€‚',
            nav: 'https://j.map.baidu.com/e8/wT'
        },
        'nb_cixi': {
            name: 'æ…ˆæºªå¸‚çœ‹å®ˆæ‰€',
            addr: 'æ…ˆæºªå¸‚è¥¿äºŒç¯åŒ—è·¯181å·',
            phone: '0574-63331923',
            money: '2000å…ƒ',
            clothes: 'å¯å¯„é€ã€‚',
            nav: 'https://j.map.baidu.com/9b/iQ'
        },
        'nb_yuyao': {
            name: 'ä½™å§šå¸‚çœ‹å®ˆæ‰€',
            addr: 'ä½™å§šå¸‚å…°æ±Ÿè¡—é“',
            phone: '0574-62866288',
            money: '2000å…ƒ',
            clothes: 'å¯å¯„é€ã€‚',
            nav: 'https://j.map.baidu.com/3c/oM'
        },
        // --- æ¸©å· ---
        'wz_city': {
            name: 'æ¸©å·å¸‚çœ‹å®ˆæ‰€',
            addr: 'æ¸©å·å¸‚é¾™æ¹¾åŒºæ²™åŸé•‡åº¦å±±æ‘',
            phone: '0577-85980114',
            money: '2000å…ƒ',
            clothes: 'ä»…é™å¿…é¡»è¡£ç‰©ã€‚',
            nav: 'https://j.map.baidu.com/8d/pL'
        }
    };

    // --- Navigation ---
    function navigateTo(viewId) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.getElementById('view-' + viewId).classList.add('active');
        if(viewId === '37days') calc37Days();
        if(viewId === 'sentencing') calcSentencing();
        if(viewId === 'guide') updateCenterInfo();
    }

    // --- Tool 1: 37 Days Logic ---
    function calc37Days() {
        const input = document.getElementById('date-37');
        const resultDiv = document.getElementById('result-37');
        if (!input.value) {
            resultDiv.style.display = 'none';
            return;
        }
        resultDiv.style.display = 'block';
        const start = new Date(input.value);
        const today = new Date();
        const diff = Math.floor((today - start) / (1000 * 60 * 60 * 24));
        document.getElementById('days-passed').innerText = diff >= 0 ? diff : 0;
        const addDays = (d, n) => { 
            const x = new Date(d); 
            x.setDate(x.getDate() + n); 
            return x.toISOString().split('T')[0]; 
        };
        document.getElementById('date-30').innerText = addDays(start, 30);
        document.getElementById('date-37-end').innerText = addDays(start, 37);
        const tag = document.getElementById('status-tag');
        if (diff > 37) {
            tag.innerText = "æ‰¹æ•å/å®¡åˆ¤é˜¶æ®µ";
            tag.style.background = "#64748b";
        } else if (diff > 30) {
            tag.innerText = "é«˜åº¦ç´§æ€¥ (æ‰¹æ•å®¡æŸ¥ä¸­)";
            tag.style.background = "#dc2626";
        } else {
            tag.innerText = "é»„é‡‘æ•‘æ´æœŸ (ä¾¦æŸ¥é˜¶æ®µ)";
            tag.style.background = "#0284c7";
        }
    }

    // --- Tool 2: Sentencing Logic ---
    const SENTENCING_DATA = {
        'fraud': [ {l:3000, t:'3å¹´ä»¥ä¸‹'}, {l:30000, t:'3-10å¹´'}, {l:500000, t:'10å¹´ä»¥ä¸Š'} ],
        'embezzlement': [ {l:30000, t:'3å¹´ä»¥ä¸‹'}, {l:1000000, t:'3-10å¹´'}, {l:999999999, t:'10å¹´ä»¥ä¸Š'} ],
        'illegal': [ {l:1000000, t:'3å¹´ä»¥ä¸‹'}, {l:5000000, t:'3-10å¹´'}, {l:999999999, t:'10å¹´ä»¥ä¸Š'} ]
    };
    function updateAmount(val) {
        document.getElementById('amount-display').innerText = val;
        calcSentencing();
    }
    function calcSentencing() {
        const type = document.getElementById('crime-select').value;
        const amount = parseInt(document.getElementById('amount-slider').value);
        const rules = SENTENCING_DATA[type];
        let result = "æœªè¾¾ç«‹æ¡ˆæ ‡å‡†";
        let desc = "å»ºè®®äº‰å–è¡Œæ”¿å¤„ç½š";
        if (amount >= rules[0].l) { result = rules[0].t; desc = "æ•°é¢è¾ƒå¤§"; }
        if (amount >= rules[1].l) { result = rules[1].t; desc = "æ•°é¢å·¨å¤§"; }
        if (amount >= rules[2].l) { result = rules[2].t; desc = "æ•°é¢ç‰¹åˆ«å·¨å¤§"; }
        document.getElementById('penalty-text').innerText = result;
        document.getElementById('threshold-desc').innerText = "å½“å‰åŒºé—´ï¼š" + desc;
    }

    // --- Tool 3: Bail Logic ---
    let bailBaseScore = 20;
    function toggleCheck(el, score) {
        el.classList.toggle('checked');
        updateBailScore();
    }
    function updateBailScore() {
        let currentScore = bailBaseScore;
        const items = document.querySelectorAll('.check-item');
        if (items[0].classList.contains('checked')) currentScore += 10;
        if (items[1].classList.contains('checked')) currentScore += 15;
        if (items[2].classList.contains('checked')) currentScore += 30;
        if (items[3].classList.contains('checked')) currentScore += 20;
        if (items[4].classList.contains('checked')) currentScore += 5;
        if (currentScore > 95) currentScore = 95;
        document.getElementById('bail-score').innerText = currentScore + "%";
        let advice = "";
        if (currentScore < 40) advice = "æˆåŠŸç‡è¾ƒä½ï¼Œå¿…é¡»å¯»æ‰¾éå¸¸è§„çªç ´å£ã€‚";
        else if (currentScore < 70) advice = "æœ‰ä¸€å®šæœºä¼šï¼Œé‡ç‚¹å®Œå–„ã€Šç¾æŠ¼å¿…è¦æ€§å®¡æŸ¥ã€‹ææ–™ã€‚";
        else advice = "æˆåŠŸç‡è¾ƒé«˜ï¼Œå»ºè®®ç«‹åˆ»å§”æ‰˜å¾‹å¸ˆï¼";
        document.getElementById('bail-advice').innerText = advice;
    }

    // --- Tool 4: Center Info Logic ---
    function updateCenterInfo() {
        const key = document.getElementById('center-select').value;
        const info = DETENTION_CENTERS[key];
        const html = `
            <div style="background:#2563eb; color:white; padding:20px; border-radius:16px; margin-bottom:16px; box-shadow:0 4px 10px rgba(37,99,235,0.3);">
                <div style="display:flex; justify-content:space-between; align-items:start;">
                    <h2 style="margin:0 0 8px; font-size:20px; flex:1;">${info.name}</h2>
                    <a href="${info.nav}" target="_blank" style="background:rgba(255,255,255,0.2); padding:6px 10px; border-radius:6px; color:white; text-decoration:none; font-size:12px; font-weight:bold;">
                        ğŸ“ å¯¼èˆª
                    </a>
                </div>
                <div style="font-size:13px; opacity:0.9; margin-bottom:12px;">åœ°å€ï¼š${info.addr}</div>
                <a href="tel:${info.phone}" style="display:inline-block; background:white; color:#2563eb; padding:8px 12px; border-radius:8px; text-decoration:none; font-size:13px; font-weight:bold;">
                    ğŸ“ æ‹¨æ‰“ ${info.phone}
                </a>
            </div>
            
            <div style="background:white; border-radius:16px; border:1px solid #e2e8f0; overflow:hidden;">
                <div style="padding:16px; border-bottom:1px solid #f1f5f9; display:flex; align-items:center;">
                    <div style="width:36px; height:36px; background:#dcfce7; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:12px; font-size:18px;">ğŸ’°</div>
                    <div>
                        <div style="font-size:12px; color:#64748b;">å­˜æ¬¾è§„å®š</div>
                        <div style="font-size:15px; font-weight:bold;">${info.money}</div>
                    </div>
                </div>
                <div style="padding:16px; border-bottom:1px solid #f1f5f9; display:flex; align-items:center;">
                     <div style="width:36px; height:36px; background:#ffedd5; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:12px; font-size:18px;">ğŸ‘•</div>
                    <div>
                        <div style="font-size:12px; color:#64748b;">è¡£ç‰©è§„å®š</div>
                        <div style="font-size:15px; font-weight:bold;">${info.clothes}</div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top:16px; background:#fefce8; border:1px solid #fef9c3; color:#854d0e; padding:16px; border-radius:12px; font-size:13px; line-height:1.6;">
                <b>âš ï¸ å¾‹å¸ˆç‰¹åˆ«æç¤ºï¼š</b><br>
                1. æµ™æ±Ÿåœ°åŒºéƒ¨åˆ†çœ‹å®ˆæ‰€ï¼ˆå¦‚æ­å·ï¼‰æ”¯æŒé‚®å±€æ±‡æ¬¾ï¼Œå­˜æ¬¾ä¸Šé™é€šå¸¸ä¸º2000-3000å…ƒã€‚<br>
                2. é€è¡£ç‰©å¿…é¡»å»é™¤æ‰€æœ‰é‡‘å±é…ä»¶ï¼ˆæ‹‰é“¾å¤´ã€çº½æ‰£ã€é‡‘å±ä¸ï¼‰ï¼Œå¦åˆ™ä¼šè¢«æ‹’æ”¶ã€‚<br>
                3. çœ¼é•œå¿…é¡»æ˜¯å…¨æ ‘è„‚ï¼ˆåŒ…æ‹¬é•œæ¡†ï¼‰ï¼Œä¸èƒ½æœ‰é‡‘å±èºä¸ã€‚
            </div>
        `;
        document.getElementById('center-info').innerHTML = html;
    }

    // --- Modal Logic ---
    function openContactModal() {
        document.getElementById('contact-modal').classList.add('open');
    }
    function closeContactModal(e) {
        if (!e || e.target.id === 'contact-modal' || e.target.tagName === 'BUTTON') {
            document.getElementById('contact-modal').classList.remove('open');
        }
    }
    function copyWeChat() {
        const el = document.createElement('textarea');
        el.value = LAWYER_INFO.wechat;
        document.body.appendChild(el);
        el.select();
        document.execCommand('copy');
        document.body.removeChild(el);
        alert('å¾®ä¿¡å·å·²å¤åˆ¶');
        closeContactModal();
    }
    
    // Init
    calcSentencing();
</script>

</body>
</html>
